import{S as Re,i as Ze,s as Ke,n as we,d as E,b as F,g as a,f as z,l as G,h as d,j as N,t as v,k as h,E as Ue,q as be,e as le,a as ge,r as Se,c as oe,m as X,p as ve,J as Te}from"./app-Ba0dBrjv.js";function Me(l,e,t){const n=l.slice();return n[29]=e[t],n}function Ae(l,e,t){const n=l.slice();return n[32]=e[t],n}function Ne(l,e,t){const n=l.slice();return n[35]=e[t],n}function Fe(l,e,t){const n=l.slice();return n[38]=e[t],n}function Ge(l){let e,t,n,s=l[13].selectScanner+"",o,i,r,u,k,p=l[13].selectScanner+"",S,B,I,O,w,P,D=l[13].selectTarget+"",b,j,m,T,Y,H=l[13].selectTarget+"",V,te,Q,y,x,K,$,g=l[13].selectProfile+"",_,A,C,ne,ae,fe,ue=l[13].filename+"",me,ke,U,_e,he,je,pe,Be,se=le(l[1]),L=[];for(let c=0;c<se.length;c+=1)L[c]=De(Fe(l,se,c));let R=l[1].length===0&&Oe(l),ie=le(l[2]),J=[];for(let c=0;c<ie.length;c+=1)J[c]=Ee(Ne(l,ie,c));let Z=l[2].length===0&&Le(l),ce=le(l[3]),q=[];for(let c=0;c<ce.length;c+=1)q[c]=Je(Ae(l,ce,c));function Pe(c,M){return c[10]?Ve:We}let de=Pe(l),W=de(l);return{c(){e=d("div"),t=d("div"),n=d("label"),o=v(s),i=N(),r=d("select"),u=d("option"),k=v("-- "),S=v(p),B=v(" --");for(let c=0;c<L.length;c+=1)L[c].c();I=N(),R&&R.c(),O=N(),w=d("div"),P=d("label"),b=v(D),j=N(),m=d("select"),T=d("option"),Y=v("-- "),V=v(H),te=v(" --");for(let c=0;c<J.length;c+=1)J[c].c();y=N(),Z&&Z.c(),x=N(),K=d("div"),$=d("label"),_=v(g),A=N(),C=d("select");for(let c=0;c<q.length;c+=1)q[c].c();ne=N(),ae=d("div"),fe=d("label"),me=v(ue),ke=N(),U=d("input"),je=N(),W.c(),h(n,"class","svelte-1mnj9h5"),u.__value="",X(u,u.__value),r.disabled=l[10],h(r,"class","svelte-1mnj9h5"),l[4]===void 0&&ve(()=>l[20].call(r)),h(t,"class","card svelte-1mnj9h5"),h(P,"class","svelte-1mnj9h5"),T.__value="",X(T,T.__value),m.disabled=Q=l[10]&&l[11].length>0,h(m,"class","svelte-1mnj9h5"),l[5]===void 0&&ve(()=>l[21].call(m)),h(w,"class","card svelte-1mnj9h5"),h($,"class","svelte-1mnj9h5"),C.disabled=l[10],h(C,"class","svelte-1mnj9h5"),l[6]===void 0&&ve(()=>l[22].call(C)),h(K,"class","card svelte-1mnj9h5"),h(fe,"class","svelte-1mnj9h5"),h(U,"type","text"),h(U,"placeholder",_e=l[13].filenamePlaceholder),U.disabled=he=l[10]&&l[11].length>0,h(U,"class","svelte-1mnj9h5"),h(ae,"class","card svelte-1mnj9h5"),h(e,"class","container svelte-1mnj9h5")},m(c,M){z(c,e,M),a(e,t),a(t,n),a(n,o),a(t,i),a(t,r),a(r,u),a(u,k),a(u,S),a(u,B);for(let f=0;f<L.length;f+=1)L[f]&&L[f].m(r,null);oe(r,l[4],!0),a(t,I),R&&R.m(t,null),a(e,O),a(e,w),a(w,P),a(P,b),a(w,j),a(w,m),a(m,T),a(T,Y),a(T,V),a(T,te);for(let f=0;f<J.length;f+=1)J[f]&&J[f].m(m,null);oe(m,l[5],!0),a(w,y),Z&&Z.m(w,null),a(e,x),a(e,K),a(K,$),a($,_),a(K,A),a(K,C);for(let f=0;f<q.length;f+=1)q[f]&&q[f].m(C,null);oe(C,l[6],!0),a(e,ne),a(e,ae),a(ae,fe),a(fe,me),a(ae,ke),a(ae,U),X(U,l[7]),a(e,je),W.m(e,null),pe||(Be=[G(r,"change",l[20]),G(m,"change",l[21]),G(C,"change",l[22]),G(U,"input",l[23])],pe=!0)},p(c,M){if(M[0]&8192&&s!==(s=c[13].selectScanner+"")&&F(o,s),M[0]&8192&&p!==(p=c[13].selectScanner+"")&&F(S,p),M[0]&2){se=le(c[1]);let f;for(f=0;f<se.length;f+=1){const ee=Fe(c,se,f);L[f]?L[f].p(ee,M):(L[f]=De(ee),L[f].c(),L[f].m(r,null))}for(;f<L.length;f+=1)L[f].d(1);L.length=se.length}if(M[0]&1024&&(r.disabled=c[10]),M[0]&18&&oe(r,c[4]),c[1].length===0?R?R.p(c,M):(R=Oe(c),R.c(),R.m(t,null)):R&&(R.d(1),R=null),M[0]&8192&&D!==(D=c[13].selectTarget+"")&&F(b,D),M[0]&8192&&H!==(H=c[13].selectTarget+"")&&F(V,H),M[0]&4){ie=le(c[2]);let f;for(f=0;f<ie.length;f+=1){const ee=Ne(c,ie,f);J[f]?J[f].p(ee,M):(J[f]=Ee(ee),J[f].c(),J[f].m(m,null))}for(;f<J.length;f+=1)J[f].d(1);J.length=ie.length}if(M[0]&3072&&Q!==(Q=c[10]&&c[11].length>0)&&(m.disabled=Q),M[0]&36&&oe(m,c[5]),c[2].length===0?Z?Z.p(c,M):(Z=Le(c),Z.c(),Z.m(w,null)):Z&&(Z.d(1),Z=null),M[0]&8192&&g!==(g=c[13].selectProfile+"")&&F(_,g),M[0]&8){ce=le(c[3]);let f;for(f=0;f<ce.length;f+=1){const ee=Ae(c,ce,f);q[f]?q[f].p(ee,M):(q[f]=Je(ee),q[f].c(),q[f].m(C,null))}for(;f<q.length;f+=1)q[f].d(1);q.length=ce.length}M[0]&1024&&(C.disabled=c[10]),M[0]&72&&oe(C,c[6]),M[0]&8192&&ue!==(ue=c[13].filename+"")&&F(me,ue),M[0]&8192&&_e!==(_e=c[13].filenamePlaceholder)&&h(U,"placeholder",_e),M[0]&3072&&he!==(he=c[10]&&c[11].length>0)&&(U.disabled=he),M[0]&128&&U.value!==c[7]&&X(U,c[7]),de===(de=Pe(c))&&W?W.p(c,M):(W.d(1),W=de(c),W&&(W.c(),W.m(e,null)))},d(c){c&&E(e),ge(L,c),R&&R.d(),ge(J,c),Z&&Z.d(),ge(q,c),W.d(),pe=!1,Se(Be)}}}function He(l){let e,t=l[13].loading+"",n;return{c(){e=d("div"),n=v(t),h(e,"class","loading svelte-1mnj9h5")},m(s,o){z(s,e,o),a(e,n)},p(s,o){o[0]&8192&&t!==(t=s[13].loading+"")&&F(n,t)},d(s){s&&E(e)}}}function Ie(l){let e;return{c(){e=v("â­ ")},m(t,n){z(t,e,n)},d(t){t&&E(e)}}}function De(l){let e,t=Qe(l[38].name)+"",n,s,o,i=l[38].is_favorite&&Ie();return{c(){e=d("option"),i&&i.c(),n=v(t),s=N(),e.__value=o=l[38].id,X(e,e.__value)},m(r,u){z(r,e,u),i&&i.m(e,null),a(e,n),a(e,s)},p(r,u){r[38].is_favorite?i||(i=Ie(),i.c(),i.m(e,n)):i&&(i.d(1),i=null),u[0]&2&&t!==(t=Qe(r[38].name)+"")&&F(n,t),u[0]&2&&o!==(o=r[38].id)&&(e.__value=o,X(e,e.__value))},d(r){r&&E(e),i&&i.d()}}}function Oe(l){let e,t=l[13].noScanners+"",n;return{c(){e=d("p"),n=v(t),h(e,"class","muted svelte-1mnj9h5")},m(s,o){z(s,e,o),a(e,n)},p(s,o){o[0]&8192&&t!==(t=s[13].noScanners+"")&&F(n,t)},d(s){s&&E(e)}}}function Ce(l){let e;return{c(){e=v("â­ ")},m(t,n){z(t,e,n)},d(t){t&&E(e)}}}function Ee(l){let e,t=l[35].name+"",n,s,o,i=l[35].is_favorite&&Ce();return{c(){e=d("option"),i&&i.c(),n=v(t),s=N(),e.__value=o=l[35].id,X(e,e.__value)},m(r,u){z(r,e,u),i&&i.m(e,null),a(e,n),a(e,s)},p(r,u){r[35].is_favorite?i||(i=Ce(),i.c(),i.m(e,n)):i&&(i.d(1),i=null),u[0]&4&&t!==(t=r[35].name+"")&&F(n,t),u[0]&4&&o!==(o=r[35].id)&&(e.__value=o,X(e,e.__value))},d(r){r&&E(e),i&&i.d()}}}function Le(l){let e,t=l[13].noTargets+"",n;return{c(){e=d("p"),n=v(t),h(e,"class","muted svelte-1mnj9h5")},m(s,o){z(s,e,o),a(e,n)},p(s,o){o[0]&8192&&t!==(t=s[13].noTargets+"")&&F(n,t)},d(s){s&&E(e)}}}function Je(l){let e,t=l[32].name+"",n,s;return{c(){e=d("option"),n=v(t),e.__value=s=l[32].id,X(e,e.__value)},m(o,i){z(o,e,i),a(e,n)},p(o,i){i[0]&8&&t!==(t=o[32].name+"")&&F(n,t),i[0]&8&&s!==(s=o[32].id)&&(e.__value=s,X(e,e.__value))},d(o){o&&E(e)}}}function Ve(l){let e,t,n,s,o=l[13].batchActive+"",i,r,u,k=l[13].pagesInBatch+"",p,S,B=l[11].length+"",I,O,w,P,D=(l[12]?l[13].scanning:l[13].addPage)+"",b,j,m,T,Y=(l[8]?l[13].scanning:l[13].finishBatch)+"",H,V,te,Q,y=l[13].cancelBatch+"",x,K,$,g=l[11].length>0&&qe(l);return{c(){e=d("div"),t=d("div"),n=d("span"),s=v("ðŸ“‘ "),i=v(o),r=N(),u=d("span"),p=v(k),S=v(": "),I=v(B),O=N(),g&&g.c(),w=N(),P=d("button"),b=v(D),j=N(),m=d("div"),T=d("button"),H=v(Y),te=N(),Q=d("button"),x=v(y),h(n,"class","batch-title svelte-1mnj9h5"),h(u,"class","badge svelte-1mnj9h5"),h(t,"class","batch-header svelte-1mnj9h5"),h(P,"class","btn btn-primary btn-large svelte-1mnj9h5"),P.disabled=l[12],h(T,"class","btn btn-success svelte-1mnj9h5"),T.disabled=V=l[11].length===0||!l[5]||!l[6]||l[8],h(Q,"class","btn btn-danger svelte-1mnj9h5"),Q.disabled=l[8],h(m,"class","batch-actions svelte-1mnj9h5"),h(e,"class","card batch-card svelte-1mnj9h5")},m(_,A){z(_,e,A),a(e,t),a(t,n),a(n,s),a(n,i),a(t,r),a(t,u),a(u,p),a(u,S),a(u,I),a(e,O),g&&g.m(e,null),a(e,w),a(e,P),a(P,b),a(e,j),a(e,m),a(m,T),a(T,H),a(m,te),a(m,Q),a(Q,x),K||($=[G(P,"click",l[16]),G(T,"click",l[17]),G(Q,"click",l[18])],K=!0)},p(_,A){A[0]&8192&&o!==(o=_[13].batchActive+"")&&F(i,o),A[0]&8192&&k!==(k=_[13].pagesInBatch+"")&&F(p,k),A[0]&2048&&B!==(B=_[11].length+"")&&F(I,B),_[11].length>0?g?g.p(_,A):(g=qe(_),g.c(),g.m(e,w)):g&&(g.d(1),g=null),A[0]&12288&&D!==(D=(_[12]?_[13].scanning:_[13].addPage)+"")&&F(b,D),A[0]&4096&&(P.disabled=_[12]),A[0]&8448&&Y!==(Y=(_[8]?_[13].scanning:_[13].finishBatch)+"")&&F(H,Y),A[0]&2412&&V!==(V=_[11].length===0||!_[5]||!_[6]||_[8])&&(T.disabled=V),A[0]&8192&&y!==(y=_[13].cancelBatch+"")&&F(x,y),A[0]&256&&(Q.disabled=_[8])},d(_){_&&E(e),g&&g.d(),K=!1,Se($)}}}function We(l){let e,t,n=(l[8]?l[13].scanning:l[13].scanSingle)+"",s,o,i,r,u=(l[8]?l[13].scanning:l[13].scanMulti)+"",k,p,S,B,I=l[13].scanBatch+"",O,w,P,D;return{c(){e=d("div"),t=d("button"),s=v(n),i=N(),r=d("button"),k=v(u),S=N(),B=d("button"),O=v(I),h(t,"class","btn btn-primary btn-large svelte-1mnj9h5"),t.disabled=o=l[8]||!l[4]||!l[5],h(r,"class","btn btn-secondary btn-large svelte-1mnj9h5"),r.disabled=p=l[8]||!l[4]||!l[5],h(B,"class","btn btn-ghost btn-large svelte-1mnj9h5"),B.disabled=w=!l[4],h(e,"class","actions svelte-1mnj9h5")},m(b,j){z(b,e,j),a(e,t),a(t,s),a(e,i),a(e,r),a(r,k),a(e,S),a(e,B),a(B,O),P||(D=[G(t,"click",l[24]),G(r,"click",l[25]),G(B,"click",l[15])],P=!0)},p(b,j){j[0]&8448&&n!==(n=(b[8]?b[13].scanning:b[13].scanSingle)+"")&&F(s,n),j[0]&310&&o!==(o=b[8]||!b[4]||!b[5])&&(t.disabled=o),j[0]&8448&&u!==(u=(b[8]?b[13].scanning:b[13].scanMulti)+"")&&F(k,u),j[0]&310&&p!==(p=b[8]||!b[4]||!b[5])&&(r.disabled=p),j[0]&8192&&I!==(I=b[13].scanBatch+"")&&F(O,I),j[0]&18&&w!==(w=!b[4])&&(B.disabled=w)},d(b){b&&E(e),P=!1,Se(D)}}}function qe(l){let e,t=le(l[11]),n=[];for(let s=0;s<t.length;s+=1)n[s]=ze(Me(l,t,s));return{c(){e=d("div");for(let s=0;s<n.length;s+=1)n[s].c();h(e,"class","batch-pages svelte-1mnj9h5")},m(s,o){z(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,o){if(o[0]&2048){t=le(s[11]);let i;for(i=0;i<t.length;i+=1){const r=Me(s,t,i);n[i]?n[i].p(r,o):(n[i]=ze(r),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&E(e),ge(n,s)}}}function ze(l){let e,t,n,s,o,i,r=l[29].pageNumber+"",u,k;return{c(){e=d("div"),t=d("img"),o=N(),i=d("div"),u=v(r),k=N(),Te(t.src,n=l[29].url)||h(t,"src",n),h(t,"alt",s="Page "+l[29].pageNumber),h(t,"class","svelte-1mnj9h5"),h(i,"class","page-number svelte-1mnj9h5"),h(e,"class","page-thumb svelte-1mnj9h5")},m(p,S){z(p,e,S),a(e,t),a(e,o),a(e,i),a(i,u),a(e,k)},p(p,S){S[0]&2048&&!Te(t.src,n=p[29].url)&&h(t,"src",n),S[0]&2048&&s!==(s="Page "+p[29].pageNumber)&&h(t,"alt",s),S[0]&2048&&r!==(r=p[29].pageNumber+"")&&F(u,r)},d(p){p&&E(e)}}}function Xe(l){let e,t,n,s,o,i,r,u=l[13].title+"",k,p,S,B=l[0]==="en"?"ðŸ‡©ðŸ‡ª":"ðŸ‡ºðŸ‡¸",I,O,w,P;document.title=e=l[13].title+" - Scan2Target";function D(m,T){return m[9]?He:Ge}let b=D(l),j=b(l);return{c(){t=d("meta"),n=N(),s=d("main"),o=d("div"),i=d("h1"),r=v("ðŸ“± "),k=v(u),p=N(),S=d("button"),I=v(B),O=N(),j.c(),h(t,"name","viewport"),h(t,"content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),h(i,"class","svelte-1mnj9h5"),h(S,"class","lang-toggle svelte-1mnj9h5"),h(o,"class","header svelte-1mnj9h5"),h(s,"class","svelte-1mnj9h5")},m(m,T){a(document.head,t),z(m,n,T),z(m,s,T),a(s,o),a(o,i),a(i,r),a(i,k),a(o,p),a(o,S),a(S,I),a(s,O),j.m(s,null),w||(P=G(S,"click",l[19]),w=!0)},p(m,T){T[0]&8192&&e!==(e=m[13].title+" - Scan2Target")&&(document.title=e),T[0]&8192&&u!==(u=m[13].title+"")&&F(k,u),T[0]&1&&B!==(B=m[0]==="en"?"ðŸ‡©ðŸ‡ª":"ðŸ‡ºðŸ‡¸")&&F(I,B),b===(b=D(m))&&j?j.p(m,T):(j.d(1),j=b(m),j&&(j.c(),j.m(s,null)))},i:we,o:we,d(m){m&&(E(n),E(s)),E(t),j.d(),w=!1,P()}}}const re="/api/v1";function Qe(l){return l.replace(/_/g," ").replace(/\[.*?\]/g,"").trim()}function Ye(l,e,t){let n,s=localStorage.getItem("scan2target_lang")||"en";const o={en:{title:"Quick Scan",selectScanner:"Select Scanner",selectTarget:"Select Target",selectProfile:"Scan Quality",filename:"Filename (optional)",filenamePlaceholder:"e.g. invoice_2025",scanSingle:"ðŸ“„ Scan Single Page",scanMulti:"ðŸ“š Scan Multi-Page (ADF)",scanBatch:"ðŸ“‘ Batch Mode",startScan:"Start Scan",addPage:"Add Page",finishBatch:"Finish Batch",cancelBatch:"Cancel",pagesInBatch:"Pages",scanning:"Scanning...",success:"âœ… Scan started!",error:"âŒ Error",pleaseSelect:"Please select scanner and target",batchActive:"Batch Mode Active",loading:"Loading...",noScanners:"No scanners found",noTargets:"No targets found"},de:{title:"Schnell-Scan",selectScanner:"Scanner wÃ¤hlen",selectTarget:"Ziel wÃ¤hlen",selectProfile:"Scan-QualitÃ¤t",filename:"Dateiname (optional)",filenamePlaceholder:"z.B. rechnung_2025",scanSingle:"ðŸ“„ Einzelseite scannen",scanMulti:"ðŸ“š Mehrere Seiten (ADF)",scanBatch:"ðŸ“‘ Stapel-Modus",startScan:"Scan starten",addPage:"Seite hinzufÃ¼gen",finishBatch:"Stapel abschlieÃŸen",cancelBatch:"Abbrechen",pagesInBatch:"Seiten",scanning:"Scanne...",success:"âœ… Scan gestartet!",error:"âŒ Fehler",pleaseSelect:"Bitte Scanner und Ziel wÃ¤hlen",batchActive:"Stapel-Modus aktiv",loading:"LÃ¤dt...",noScanners:"Keine Scanner gefunden",noTargets:"Keine Ziele gefunden"}};let i=[],r=[],u=[],k="",p="",S="",B="",I=!1,O=!0,w=!1,P=[],D=!1;Ue(async()=>{await b();const g=i.find(A=>A.is_favorite);g&&t(4,k=g.id);const _=r.find(A=>A.is_favorite);_&&t(5,p=_.id)});async function b(){t(9,O=!0);try{const g=await fetch(`${re}/devices`);if(g.ok){const C=await g.json();t(1,i=C.filter(ne=>ne.device_type==="scanner"))}const _=await fetch(`${re}/targets`);_.ok&&t(2,r=await _.json());const A=await fetch(`${re}/scan/profiles`);if(A.ok&&(t(3,u=await A.json()),u.length>0)){const C=u.find(ne=>ne.id.includes("200"));t(6,S=C?C.id:u[0].id)}}catch(g){console.error("Load error:",g)}finally{t(9,O=!1)}}async function j(g="Flatbed"){if(!k||!p){alert(n.pleaseSelect);return}t(8,I=!0);try{const _=await fetch(`${re}/scan/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:k,profile_id:S,target_id:p,filename_prefix:B||"scan"})});if(_.ok)alert(n.success),t(7,B="");else{const A=await _.json();alert(`${n.error}: ${A.detail||"Unknown error"}`)}}catch(_){alert(`${n.error}: ${_.message}`)}finally{t(8,I=!1)}}function m(){if(!k){alert(n.pleaseSelect);return}t(10,w=!0),t(11,P=[])}async function T(){if(!k||!S){alert(n.pleaseSelect);return}t(12,D=!0);try{const g=await fetch(`${re}/scan/preview`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:k,profile_id:S})});if(g.ok){const _=await g.json();P.push({id:Date.now(),url:_.image,pageNumber:P.length+1})}else{const _=await g.json();alert(`${n.error}: ${_.detail||"Scan failed"}`)}}catch(g){alert(`${n.error}: ${g.message}`)}finally{t(12,D=!1)}}async function Y(){if(P.length===0||!p){alert(n.pleaseSelect);return}if(!S){alert(n.pleaseSelect);return}t(8,I=!0);try{const g=await fetch(`${re}/scan/batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:k,profile_id:S,target_id:p,filename_prefix:B||"batch_scan",page_urls:P.map(_=>_.url)})});if(g.ok)alert(n.success),t(10,w=!1),t(11,P=[]),t(7,B="");else{const _=await g.json();alert(`${n.error}: ${_.detail||"Unknown error"}`)}}catch(g){alert(`${n.error}: ${g.message}`)}finally{t(8,I=!1)}}function H(){t(10,w=!1),t(11,P=[])}const V=()=>t(0,s=s==="en"?"de":"en");function te(){k=be(this),t(4,k),t(1,i)}function Q(){p=be(this),t(5,p),t(2,r)}function y(){S=be(this),t(6,S),t(3,u)}function x(){B=this.value,t(7,B)}const K=()=>j("Flatbed"),$=()=>j("ADF");return l.$$.update=()=>{l.$$.dirty[0]&1&&t(13,n=o[s])},[s,i,r,u,k,p,S,B,I,O,w,P,D,n,j,m,T,Y,H,V,te,Q,y,x,K,$]}class ye extends Re{constructor(e){super(),Ze(this,e,Ye,Xe,Ke,{},null,[-1,-1])}}new ye({target:document.getElementById("app")});
